!function(){"use strict";const e=()=>{let e,t=1,s=1,r=!1;const i=document.getElementById("survey");if(!i)return;const n=i.querySelector(".js-survey-steps"),c=i.querySelector(".js-survey-progress");e=n.querySelectorAll(".js-survey-step").length;const l=i.querySelector(".js-survey-prev"),u=i.querySelector(".js-survey-next");const d=e=>i.querySelector('.js-survey-step[data-step="'+e+'"]').querySelector('input[type="radio"]:checked').value;function p(t){const o=i.querySelector('.js-survey-step[data-step="'+t+'"]');o&&(t<=2?document.getElementById("popup-test").style.backgroundImage="url(./images/test-bg-1.jpg)":t<=4?document.getElementById("popup-test").style.backgroundImage="url(./images/test-bg-2.jpg)":t<=6&&(document.getElementById("popup-test").style.backgroundImage="url(./images/test-bg-3.jpg)"),r=t==e,n.querySelectorAll(".js-survey-step").forEach(e=>{e.classList.remove("is-active"),e.style.opacity=0}),o.classList.add("is-active"),setTimeout(()=>{o.style.opacity=1},0),s=1,c.querySelectorAll(".survey__progress-step").forEach(e=>{s<=t?e.classList.add("is-active"):e.classList.remove("is-active"),s++}))}s=1,n.querySelectorAll(".js-survey-step").forEach(e=>{e.querySelectorAll("input").forEach(e=>{e.addEventListener("change",function(){u.disabled=!1})});const t=document.createElement("div");t.classList.add("survey__progress-step"),1==s&&t.classList.add("is-active"),c.appendChild(t),s++}),l.addEventListener("click",function(e){p(--t),u.disabled=!1,1==t&&(l.style.display="none"),l.innerHTML="Шаг "+(t-1),u.innerHTML="Шаг "+(t+1)}),u.addEventListener("click",function(e){l.style.display="block",u.disabled=!0,r?(document.getElementById("popup-test").style.backgroundImage="url(./images/test-bg-4.jpg)","1"==d(1)&&"1"==d(2)&&"2"==d(3)&&"2"==d(4)&&"2"==d(5)&&"2"==d(6)?a("popup-survey-result-1"):a("popup-survey-result-2"),setTimeout(()=>{o("popup-test")},1e3),i.querySelectorAll('input[type="radio"]').forEach(e=>{e.checked=!1}),t=1,r=!1,l.style.display="none",setTimeout(()=>{p(t)},1e3)):p(++t),l.innerHTML="Шаг "+(t-1),u.innerHTML=r?"Отправить":"Шаг "+(t+1)})},t=()=>{document.querySelectorAll(".video").forEach(e=>{e.addEventListener("click",function(t){t.preventDefault(),0==this.classList.contains("is-active")&&(this.classList.add("is-active"),this.querySelector("video").play(),this.querySelector("video").addEventListener("ended",()=>{e.classList.remove("is-active")}),this.querySelector("video").addEventListener("pause",function(){4==this.readyState&&e.classList.remove("is-active")}))})})},s=()=>{document.querySelectorAll("audio").forEach(e=>{e.pause()})},r=()=>{const e=e=>{const t=Math.floor(e/60),s=Math.floor(e%60);return`${0==t?"00":t<10?`0${t}`:`${t}`}:${0==s?"00":s<10?`0${s}`:`${s}`}`};document.querySelectorAll(".audio").forEach(t=>{if(1==t.dataset.init)return;const s=t.querySelector("audio");if(!s)return;const r=t.querySelector(".audio__duration");s.addEventListener("loadedmetadata",()=>{r.textContent=void 0!==t.dataset.detailedDuration?"00:00 / "+e(s.duration):e(s.duration)}),s.addEventListener("timeupdate",()=>{r.textContent=void 0!==t.dataset.detailedDuration?e(Math.floor(s.currentTime))+" / "+e(s.duration):e(s.duration-Math.floor(s.currentTime))}),t.querySelector(".audio__play .button-audio").addEventListener("click",()=>{t.querySelector(".audio__play").classList.remove("is-active"),t.querySelector(".audio__pause").classList.add("is-active"),s.play()}),t.querySelector(".audio__pause .button-audio").addEventListener("click",()=>{t.querySelector(".audio__play").classList.add("is-active"),t.querySelector(".audio__pause").classList.remove("is-active"),s.pause()}),t.dataset.init=!0})};function o(e){let t=document.getElementById(e)?document.getElementById(e):this.closest(".popup");t.dataset.processing&&1==t.dataset.processing||(t.dataset.processing=!0,t.classList.contains("is-shown")&&(t.addEventListener("transitionend",e=>{t.style.display="none",t.dataset.processing=!1},{once:!0}),t.classList.remove("is-shown"),document.body.classList.remove("no-scroll"),"popup-teacher"==e&&s()))}function a(e,t){let s=document.getElementById(e);if("popup-nav"!=e&&o("popup-nav"),"popup-signup-options"!=e&&o("popup-signup-options"),"popup-survey-result-1"!=e&&o("popup-survey-result-1"),"popup-survey-result-2"!=e&&o("popup-survey-result-2"),"popup-lesson"!=e&&o("popup-lesson"),"popup-teacher"!=e&&o("popup-teacher"),"popup-teacher"==e&&r(),"popup-test"==e&&(i("./images/test-bg-1.jpg"),i("./images/test-bg-2.jpg"),i("./images/test-bg-3.jpg"),i("./images/test-bg-4.jpg")),t&&void 0!==t.subject&&(document.getElementById("popup-signup-form").querySelector('input[name="subject"]').value=t.subject,document.getElementById("popup-signup-form-second").querySelector('input[name="subject"]').value=t.subject),(!s.dataset.processing||1!=s.dataset.processing)&&(s.dataset.processing=!0,0==s.classList.contains("is-shown"))){if(t&&void 0!==t.file){var a=new XMLHttpRequest;a.open("GET",t.file,!0),a.onreadystatechange=function(){4===this.readyState&&200===this.status&&(s.querySelector(".popup-window").innerHTML=this.responseText,"popup-teacher"==e&&r())},a.send()}s.style.display="flex",setTimeout(function(){s.classList.add("is-shown"),document.body.classList.add("no-scroll"),s.dataset.processing=!1},1)}}function i(e){(new Image).src=e}const n=()=>{const e=document.querySelectorAll(".js-tabs");e&&e.forEach(e=>{const t=e.querySelectorAll(".js-tabs-button"),s=e.querySelectorAll(".js-tabs-content");t&&s&&t.forEach(r=>{r.addEventListener("click",r=>{const o=r.target.dataset.id;if(o){if(t.forEach(e=>{e.classList.remove("is-active")}),r.target.classList.add("is-active"),s.forEach(e=>{e.classList.remove("is-active")}),!document.getElementById(o))return;document.getElementById(o).classList.add("is-active")}r.target.dataset.prices&&(t.forEach(e=>{e.classList.remove("is-active")}),r.target.classList.add("is-active"),function(e){const t=e.querySelector(".js-tabs-button.is-active"),s=JSON.parse(t.dataset.prices).prices;let r=0;e.querySelectorAll(".prices-item__price-number").forEach(e=>{e.querySelector("span").textContent=s[r],r++})}(e))})})})};document.addEventListener("DOMContentLoaded",()=>{if(document.querySelectorAll(".js-accordion .accordion__header").forEach(e=>{e.addEventListener("click",function(){const t=e.closest(".accordion__item").classList.contains("is-active"),s=e.querySelector(".button-arrow");t||(document.querySelectorAll(".accordion__item").forEach(e=>{const t=e.querySelector(".button-arrow");e.classList.remove("is-active"),t.classList.add("button-arrow--down"),t.classList.remove("button-arrow--up"),t.classList.remove("button-arrow--filled")}),s.classList.toggle("button-arrow--down"),s.classList.toggle("button-arrow--up"),s.classList.toggle("button-arrow--filled"),e.closest(".accordion__item").classList.toggle("is-active"))})}),e(),document.querySelectorAll(".js-mail-form").forEach(e=>{e.querySelector(".js-submit").addEventListener("click",t=>{t.preventDefault(),e.dataset.errors=0;const s=e.querySelector('input[name="phone"]'),r=e.querySelector('input[name="name"]');if(e.querySelector('input[name="email"]'),s&&(0==s.value.length?(s.classList.add("is-error"),e.dataset.errors++):s.classList.remove("is-error")),r&&(0==r.value.length?(r.classList.add("is-error"),e.dataset.errors++):r.classList.remove("is-error")),e.dataset.errors>0)return void(e.querySelector(".js-warning").style.display="block");e.querySelector(".js-warning").style.display="none";const o=new FormData(e);fetch("https://killboard-1.com/etc/mail/mailer.php",{method:"POST",body:o}).then(function(e){return e.json()}).then(function(e){if(e.error)return alert(e.error),!1;alert("Сообщение отправлено")})})}),t(),r(),n(),IMask(document.querySelector(".js-mask-phone"),{mask:"+{7} (000) 000-00-00"}),document.querySelectorAll(".popup").forEach(e=>{e.addEventListener("click",function(t){t.target==e&&o(t.target.id)})}),document.body.addEventListener("click",function(e){const t=e.target.closest(".js-popup-hide");t&&(e.preventDefault(),o.call(t));const s=e.target.closest(".js-popup-show");s&&(e.preventDefault(),a(s.dataset.target,s.dataset))}),window.innerWidth>=1280){new Swiper(".swiper-teachers",{slidesPerView:4,spaceBetween:40,navigation:{nextEl:".swiper-teachers-next",prevEl:".swiper-teachers-prev"}})}if(document.querySelector(".js-swiper-speak")){const e=document.querySelector(".js-swiper-speak-pagination");let t,s=document.querySelector(".js-swiper-speak").querySelectorAll(".swiper-slide").length;for(let t=0;t<s;t++){const t=document.createElement("div");t.classList.add("speak__card__slider-page"),t.classList.add("js-swiper-speak-page"),e.appendChild(t)}new Swiper(".js-swiper-speak",{autoplay:{delay:2500,disableOnInteraction:!1},on:{autoplayTimeLeft(t,s,r){r=Math.round(100*(1-r)),e.style.setProperty("--progress",r+"%")},init:function(e){},slideChange:function(s){s.realIndex!=t&&(e.querySelectorAll(".js-swiper-speak-page").forEach(e=>{e.classList.remove("is-active")}),e.querySelectorAll(".js-swiper-speak-page")[s.realIndex].classList.add("is-active"),t=s.realIndex)}},slidesPerView:"auto",spaceBetween:20,loop:!0})}})}();
//# sourceMappingURL=main.js.map

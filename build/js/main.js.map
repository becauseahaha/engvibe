{"version":3,"file":"main.js","sources":["../../src/js/main.js"],"sourcesContent":["if (window.innerWidth >= 768) {\n    const msnry = new Masonry('.stories__items', {\n        itemSelector: '.stories-item',\n        columnWidth: '.stories-item--width',\n        gutter: '.stories-item--gap',\n        horizontalOrder: true,\n        percentPosition: true\n    });\n}\n\nfunction resetSurvey() {\n    // const $box = document.getElementById('survey');\n    // if (!$box) return;\n\n    // $box.dataset.step = 1;\n\n    // $box.querySelectorAll('input').forEach(element => {\n    //     element.checked = false\n    // });\n}\n\nconst survey = () => {\n\n    let step = 1;\n    let steps_total;\n    let i = 1;\n    let is_last = false;\n\n    const $box = document.getElementById('survey');\n    if (!$box) return;\n    \n    const $steps = $box.querySelector('.js-survey-steps');\n    const $progress = $box.querySelector('.js-survey-progress')\n\n    steps_total = $steps.querySelectorAll('.js-survey-step').length;\n\n    const $prev = $box.querySelector('.js-survey-prev');\n    const $next = $box.querySelector('.js-survey-next');\n\n    function showResult() {\n        hidePopup('popup-test')\n        showPopup('popup-survey-result-1')\n    }\n\n    function showStep(step) {\n\n        const $form = $box.querySelector('.js-survey-step[data-step=\"' +step+ '\"]');\n        if (!$form) return\n\n        is_last = (step == steps_total);\n\n        $steps.querySelectorAll('.js-survey-step').forEach(element => {\n            element.classList.remove('is-active')\n            element.style.opacity = 0;\n        });\n        $form.classList.add('is-active');\n        setTimeout(() => {\n            $form.style.opacity = 1;\n        }, 0);\n\n        i = 1;\n        $progress.querySelectorAll('.survey__progress-step').forEach(element => {\n            if (i <= step) {\n                element.classList.add('is-active')\n            } else {\n                element.classList.remove('is-active')\n            }\n            i++;\n        });\n    }\n\n    i = 1;\n    $steps.querySelectorAll('.js-survey-step').forEach(element => {\n\n        element.querySelectorAll('input').forEach(radio => {\n            radio.addEventListener('change', function() {\n                $next.disabled = false;\n            })\n        })\n\n        const div = document.createElement(\"div\");\n        div.classList.add('survey__progress-step')\n        if (i == 1) {\n            div.classList.add('is-active')\n        }\n        $progress.appendChild(div)\n\n        i++;\n    })\n\n    $prev.addEventListener('click', function(e) {\n        step--;\n        showStep(step)\n        $next.disabled = false;\n        if (step == 1) {\n            $prev.style.display = 'none';\n        }\n        $prev.innerHTML = 'Шаг ' + (step-1);\n        $next.innerHTML = 'Шаг ' + (step+1);\n    })\n    $next.addEventListener('click', function(e) {\n        step++;\n        if (!is_last) {\n            showStep(step)\n        } else {\n            showResult()\n        }\n        $prev.style.display = 'block';\n        $next.disabled = true;\n        $prev.innerHTML = 'Шаг ' + (step-1);\n        if (!is_last) {\n            $next.innerHTML = 'Шаг ' + (step+1);\n        } else {\n            $next.innerHTML = 'Отправить';\n        }\n    })\n}\n\nconst accordion = () => {\n    document.querySelectorAll('.js-accordion .accordion__header').forEach((el) => {\n        el.addEventListener('click', function() {\n\n            const self = el.closest('.accordion__item').classList.contains('is-active');\n            const $btn = el.querySelector('.button-arrow');\n            \n            if (self) return;\n\n            document.querySelectorAll('.accordion__item').forEach((el) => {\n                const $btn = el.querySelector('.button-arrow');\n                el.classList.remove('is-active');\n                $btn.classList.add('button-arrow--down')\n                $btn.classList.remove('button-arrow--up')\n                $btn.classList.remove('button-arrow--filled')\n            })\n            \n\n            $btn.classList.toggle('button-arrow--down')\n            $btn.classList.toggle('button-arrow--up')\n            $btn.classList.toggle('button-arrow--filled')\n\n            el.closest('.accordion__item').classList.toggle('is-active');\n        })\n    })\n}\n\n\nfunction hidePopup(id) {\n    let popup = document.getElementById(id)\n        ? document.getElementById(id)\n        : this.closest(\".popup\");\n\n    if (popup.dataset.processing && popup.dataset.processing == true) return;\n    popup.dataset.processing = true;\n\n    if (popup.classList.contains(\"is-shown\")) {\n        popup.addEventListener(\n            \"transitionend\",\n            (e) => {\n                popup.style.display = \"none\";\n                popup.dataset.processing = false;\n            },\n            {\n                once: true,\n            }\n        );\n        popup.classList.remove(\"is-shown\");\n        document.body.classList.remove(\"no-scroll\");\n    }\n}\n\nfunction showPopup(id, dataset) {\n    let popup = document.getElementById(id);\n\n    if (id != 'popup-nav') hidePopup('popup-nav');\n    if (id != 'popup-signup-options') hidePopup('popup-signup-options');\n    if (id != 'popup-survey-result-1') hidePopup('popup-survey-result-1');\n    if (id != 'popup-lesson') hidePopup('popup-lesson');\n    if (id != 'popup-teacher') hidePopup('popup-teacher');\n\n    if (id == 'popup-test') {\n        resetSurvey();\n    }\n\n    if (popup.dataset.processing && popup.dataset.processing == true) return;\n    popup.dataset.processing = true;\n\n    if (popup.classList.contains(\"is-shown\") == false) {\n\n        if (dataset.file) {\n            var xhr= new XMLHttpRequest();\n            xhr.open('GET', dataset.file, true);\n            xhr.onreadystatechange= function() {\n                if (this.readyState!==4) return;\n                if (this.status!==200) return;\n                popup.querySelector('.popup-window').innerHTML= this.responseText;\n            };\n            xhr.send();\n        }\n\n        popup.style.display = \"flex\";\n        setTimeout(function () {\n            popup.classList.add(\"is-shown\");\n            document.body.classList.add(\"no-scroll\");\n            popup.dataset.processing = false;\n        }, 1);\n    }\n}\n\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n\n    accordion();\n    survey();\n\n    IMask(document.querySelector('.js-mask-phone'), {\n            mask: '+{7} (000) 000-00-00'\n    })\n\n    document.querySelectorAll(\".popup\").forEach((el) => {\n        el.addEventListener(\"click\", function (e) {\n            if (e.target == el) {\n                hidePopup(e.target.id);\n            }\n        });\n    });\n    document.body.addEventListener('click', function(e) {\n\n        const $close = e.target.closest(\".js-popup-hide\");\n        if ($close) {\n            e.preventDefault();\n            hidePopup.call($close);\n        }\n        \n        const $show = e.target.closest(\".js-popup-show\");\n        if ($show) {\n            e.preventDefault();\n            showPopup($show.dataset.target, $show.dataset);\n        }\n    })\n    // document.querySelectorAll(\".js-popup-hide\").forEach((el) => {\n    //     el.addEventListener(\"click\", hidePopup.bind(el));\n    // });\n    // document.querySelectorAll(\".js-popup-show\").forEach((el) => {\n    //     el.addEventListener(\"click\", (e) => {\n    //         e.preventDefault();\n    //         showPopup(el.dataset.target, el.dataset);\n    //     });\n    // });\n})"],"names":["window","innerWidth","Masonry","survey","steps_total","step","i","is_last","$box","document","getElementById","$steps","querySelector","$progress","querySelectorAll","length","$prev","$next","showStep","$form","forEach","element","classList","remove","style","opacity","add","radio","addEventListener","disabled","div","createElement","appendChild","e","display","innerHTML","hidePopup","id","popup","this","closest","dataset","processing","contains","body","showPopup","file","xhr","XMLHttpRequest","open","onreadystatechange","readyState","status","responseText","send","el","self","$btn","toggle","target","$close","preventDefault","call","$show"],"mappings":"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"}
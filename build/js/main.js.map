{"version":3,"file":"main.js","sources":["../../src/js/main.js"],"sourcesContent":["if (window.innerWidth >= 768) {\n    const msnry = new Masonry(\".stories__items\", {\n        itemSelector: \".stories-item\",\n        columnWidth: \".stories-item--width\",\n        gutter: \".stories-item--gap\",\n        horizontalOrder: true,\n        percentPosition: true,\n    });\n}\n\nconst forms = () => {\n    const $forms = document.querySelectorAll(\".js-mail-form\");\n\n    $forms.forEach(($form) => {\n        const $submit = $form.querySelector(\".js-submit\");\n\n        $submit.addEventListener(\"click\", (e) => {\n            e.preventDefault();\n\n            $form.dataset.errors = 0;\n\n            const $phone = $form.querySelector('input[name=\"phone\"]');\n            const $name = $form.querySelector('input[name=\"name\"]');\n            const $email = $form.querySelector('input[name=\"email\"]');\n\n            if ($phone) {\n                if ($phone.value.length == 0) {\n                    $phone.classList.add(\"is-error\");\n                    $form.dataset.errors++;\n                } else {\n                    $phone.classList.remove(\"is-error\");\n                }\n            }\n            if ($name) {\n                if ($name.value.length == 0) {\n                    $name.classList.add(\"is-error\");\n                    $form.dataset.errors++;\n                } else {\n                    $name.classList.remove(\"is-error\");\n                }\n            }\n            if ($email) {\n                if ($email.value.length == 0) {\n                    $email.classList.add(\"is-error\");\n                    $form.dataset.errors++;\n                } else {\n                    $email.classList.remove(\"is-error\");\n                }\n            }\n\n            if ($form.dataset.errors > 0) {\n                $form.querySelector(\".js-warning\").style.display = \"block\";\n                return;\n            } else {\n                $form.querySelector(\".js-warning\").style.display = \"none\";\n            }\n\n            const formData = new FormData($form);\n\n            fetch(\"/mailer.php\", {\n                method: \"POST\",\n                body: formData,\n            })\n                .then(function (serverPromise) {\n                    return serverPromise.json();\n                })\n                .then(function (data) {\n                    if (data.error) {\n                        alert(data.error);\n                        return false;\n                    }\n                    alert(\"Сообщение отправлено\");\n                });\n        });\n    });\n};\n\nfunction resetSurvey() {\n    // const $box = document.getElementById('survey');\n    // if (!$box) return;\n    // $box.dataset.step = 1;\n    // $box.querySelectorAll('input').forEach(element => {\n    //     element.checked = false\n    // });\n}\n\nconst survey = () => {\n    let step = 1;\n    let steps_total;\n    let i = 1;\n    let is_last = false;\n\n    const $box = document.getElementById(\"survey\");\n    if (!$box) return;\n\n    const $steps = $box.querySelector(\".js-survey-steps\");\n    const $progress = $box.querySelector(\".js-survey-progress\");\n\n    steps_total = $steps.querySelectorAll(\".js-survey-step\").length;\n\n    const $prev = $box.querySelector(\".js-survey-prev\");\n    const $next = $box.querySelector(\".js-survey-next\");\n\n    function showResult() {\n        hidePopup(\"popup-test\");\n        showPopup(\"popup-survey-result-1\");\n    }\n\n    function showStep(step) {\n        const $form = $box.querySelector(\n            '.js-survey-step[data-step=\"' + step + '\"]'\n        );\n        if (!$form) return;\n\n        is_last = step == steps_total;\n\n        $steps.querySelectorAll(\".js-survey-step\").forEach((element) => {\n            element.classList.remove(\"is-active\");\n            element.style.opacity = 0;\n        });\n        $form.classList.add(\"is-active\");\n        setTimeout(() => {\n            $form.style.opacity = 1;\n        }, 0);\n\n        i = 1;\n        $progress\n            .querySelectorAll(\".survey__progress-step\")\n            .forEach((element) => {\n                if (i <= step) {\n                    element.classList.add(\"is-active\");\n                } else {\n                    element.classList.remove(\"is-active\");\n                }\n                i++;\n            });\n    }\n\n    i = 1;\n    $steps.querySelectorAll(\".js-survey-step\").forEach((element) => {\n        element.querySelectorAll(\"input\").forEach((radio) => {\n            radio.addEventListener(\"change\", function () {\n                $next.disabled = false;\n            });\n        });\n\n        const div = document.createElement(\"div\");\n        div.classList.add(\"survey__progress-step\");\n        if (i == 1) {\n            div.classList.add(\"is-active\");\n        }\n        $progress.appendChild(div);\n\n        i++;\n    });\n\n    $prev.addEventListener(\"click\", function (e) {\n        step--;\n        showStep(step);\n        $next.disabled = false;\n        if (step == 1) {\n            $prev.style.display = \"none\";\n        }\n        $prev.innerHTML = \"Шаг \" + (step - 1);\n        $next.innerHTML = \"Шаг \" + (step + 1);\n    });\n    $next.addEventListener(\"click\", function (e) {\n        step++;\n        if (!is_last) {\n            showStep(step);\n        } else {\n            showResult();\n        }\n        $prev.style.display = \"block\";\n        $next.disabled = true;\n        $prev.innerHTML = \"Шаг \" + (step - 1);\n        if (!is_last) {\n            $next.innerHTML = \"Шаг \" + (step + 1);\n        } else {\n            $next.innerHTML = \"Отправить\";\n        }\n    });\n};\n\nconst accordion = () => {\n    document\n        .querySelectorAll(\".js-accordion .accordion__header\")\n        .forEach((el) => {\n            el.addEventListener(\"click\", function () {\n                const self = el\n                    .closest(\".accordion__item\")\n                    .classList.contains(\"is-active\");\n                const $btn = el.querySelector(\".button-arrow\");\n\n                if (self) return;\n\n                document.querySelectorAll(\".accordion__item\").forEach((el) => {\n                    const $btn = el.querySelector(\".button-arrow\");\n                    el.classList.remove(\"is-active\");\n                    $btn.classList.add(\"button-arrow--down\");\n                    $btn.classList.remove(\"button-arrow--up\");\n                    $btn.classList.remove(\"button-arrow--filled\");\n                });\n\n                $btn.classList.toggle(\"button-arrow--down\");\n                $btn.classList.toggle(\"button-arrow--up\");\n                $btn.classList.toggle(\"button-arrow--filled\");\n\n                el.closest(\".accordion__item\").classList.toggle(\"is-active\");\n            });\n        });\n};\n\nfunction hidePopup(id) {\n    let popup = document.getElementById(id)\n        ? document.getElementById(id)\n        : this.closest(\".popup\");\n\n    if (popup.dataset.processing && popup.dataset.processing == true) return;\n    popup.dataset.processing = true;\n\n    if (popup.classList.contains(\"is-shown\")) {\n        popup.addEventListener(\n            \"transitionend\",\n            (e) => {\n                popup.style.display = \"none\";\n                popup.dataset.processing = false;\n            },\n            {\n                once: true,\n            }\n        );\n        popup.classList.remove(\"is-shown\");\n        document.body.classList.remove(\"no-scroll\");\n    }\n}\n\nconst videos = () => {\n\n    document.querySelectorAll('.video').forEach((el) => {\n        el.addEventListener('click', function(e) {\n            e.preventDefault();\n            if (this.classList.contains('is-active') == false) {\n                this.classList.add('is-active')\n                this.querySelector('video').play();\n            }\n        })\n    })\n\n}\n\nfunction showPopup(id, dataset) {\n    let popup = document.getElementById(id);\n\n    if (id != \"popup-nav\") hidePopup(\"popup-nav\");\n    if (id != \"popup-signup-options\") hidePopup(\"popup-signup-options\");\n    if (id != \"popup-survey-result-1\") hidePopup(\"popup-survey-result-1\");\n    if (id != \"popup-lesson\") hidePopup(\"popup-lesson\");\n    if (id != \"popup-teacher\") hidePopup(\"popup-teacher\");\n\n    if (id == \"popup-test\") {\n        resetSurvey();\n    }\n\n    if (popup.dataset.processing && popup.dataset.processing == true) return;\n    popup.dataset.processing = true;\n\n    if (popup.classList.contains(\"is-shown\") == false) {\n        if (dataset.file) {\n            var xhr = new XMLHttpRequest();\n            xhr.open(\"GET\", dataset.file, true);\n            xhr.onreadystatechange = function () {\n                if (this.readyState !== 4) return;\n                if (this.status !== 200) return;\n                popup.querySelector(\".popup-window\").innerHTML =\n                    this.responseText;\n            };\n            xhr.send();\n        }\n\n        popup.style.display = \"flex\";\n        setTimeout(function () {\n            popup.classList.add(\"is-shown\");\n            document.body.classList.add(\"no-scroll\");\n            popup.dataset.processing = false;\n        }, 1);\n    }\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    accordion();\n    survey();\n    forms();\n    videos();\n\n    IMask(document.querySelector(\".js-mask-phone\"), {\n        mask: \"+{7} (000) 000-00-00\",\n    });\n\n    document.querySelectorAll(\".popup\").forEach((el) => {\n        el.addEventListener(\"click\", function (e) {\n            if (e.target == el) {\n                hidePopup(e.target.id);\n            }\n        });\n    });\n    document.body.addEventListener(\"click\", function (e) {\n        const $close = e.target.closest(\".js-popup-hide\");\n        if ($close) {\n            e.preventDefault();\n            hidePopup.call($close);\n        }\n\n        const $show = e.target.closest(\".js-popup-show\");\n        if ($show) {\n            e.preventDefault();\n            showPopup($show.dataset.target, $show.dataset);\n        }\n    });\n\n    if (window.innerWidth >= 1280) {\n        const swiperClients = new Swiper(\".swiper-teachers\", {\n            slidesPerView: 4,\n            spaceBetween: 40,\n            // loop: true,\n            navigation: {\n                nextEl: \".swiper-teachers-next\",\n                prevEl: \".swiper-teachers-prev\",\n            },\n        });\n    }\n\n\n    const $swiperSpeakPages = document.querySelector('.js-swiper-speak-pagination');\n    let progress = 0;\n    let realIndex;\n    let slidesqty = document.querySelector('.js-swiper-speak').querySelectorAll('.swiper-slide').length;\n    for (let index = 0; index < slidesqty; index++) {\n        const div = document.createElement(\"div\");\n        div.classList.add(\"speak__card__slider-page\");\n        div.classList.add(\"js-swiper-speak-page\");\n        $swiperSpeakPages.appendChild(div);\n    }\n    const swiperClients = new Swiper(\".js-swiper-speak\", {\n        autoplay: {\n            delay: 2500,\n            disableOnInteraction: false,\n        },\n        on: {\n            autoplayTimeLeft(s, time, progress) {\n                progress = Math.round((1 - progress)*100);\n                $swiperSpeakPages.style.setProperty(\"--progress\", progress  + '%');\n            },\n            init: function(s) {\n            },\n            slideChange: function(s) {\n                if (s.realIndex != realIndex) {\n\n                    $swiperSpeakPages.querySelectorAll('.js-swiper-speak-page').forEach((el) => {\n                        el.classList.remove('is-active')\n                    });\n                    $swiperSpeakPages.querySelectorAll('.js-swiper-speak-page')[s.realIndex].classList.add('is-active');\n\n                    realIndex = s.realIndex;\n                }\n            }\n        },\n        slidesPerView: \"auto\",\n        spaceBetween: 20,\n        loop: true,\n    });\n});\n"],"names":["window","innerWidth","Masonry","survey","steps_total","step","i","is_last","$box","document","getElementById","$steps","querySelector","$progress","querySelectorAll","length","$prev","$next","showStep","$form","forEach","element","classList","remove","style","opacity","add","radio","addEventListener","disabled","div","createElement","appendChild","e","display","innerHTML","hidePopup","id","popup","this","closest","dataset","processing","contains","body","videos","el","preventDefault","play","showPopup","file","xhr","XMLHttpRequest","open","onreadystatechange","readyState","status","responseText","send","self","$btn","toggle","errors","$phone","$name","$email","value","formData","FormData","then","serverPromise","json","data","error","target","$close","call","$show","Swiper","$swiperSpeakPages","realIndex","slidesqty","index","s","time","progress","Math","round","setProperty"],"mappings":"yBAAA,GAAIA,OAAOC,YAAc,IAAK,CACZ,IAAIC,QAAQ,gCACR,4BACD,8BACL,sCACS,mBACA,IAIzB,MA4EMC,EAAS,SAEPC,EADAC,EAAO,EAEPC,EAAI,EACJC,GAAU,QAERC,EAAOC,SAASC,eAAe,cAChCF,EAAM,aAELG,EAASH,EAAKI,cAAc,oBAC5BC,EAAYL,EAAKI,cAAc,yBAEvBD,EAAOG,iBAAiB,mBAAmBC,aAEnDC,EAAQR,EAAKI,cAAc,mBAC3BK,EAAQT,EAAKI,cAAc,4BAOxBM,EAASb,SACRc,EAAQX,EAAKI,cACf,8BAAgCP,EAAO,MAEtCc,MAEKd,GAAQD,IAEXU,iBAAiB,mBAAmBM,QAASC,MACxCC,UAAUC,OAAO,eACjBC,MAAMC,QAAU,MAEtBH,UAAUI,IAAI,wBACT,OACDF,MAAMC,QAAU,GACvB,KAEC,IAECX,iBAAiB,0BACjBM,QAASC,IACFf,GAAKD,IACGiB,UAAUI,IAAI,eAEdJ,UAAUC,OAAO,sBAMrC,IACGT,iBAAiB,mBAAmBM,QAASC,MACxCP,iBAAiB,SAASM,QAASO,MACjCC,iBAAiB,SAAU,aACvBC,UAAW,YAInBC,EAAMrB,SAASsB,cAAc,SAC/BT,UAAUI,IAAI,yBACT,GAALpB,KACIgB,UAAUI,IAAI,eAEZM,YAAYF,WAKpBF,iBAAiB,QAAS,SAAUK,YAGhCJ,UAAW,EACL,GAARxB,MACMmB,MAAMU,QAAU,UAEpBC,UAAY,QAAU9B,EAAO,KAC7B8B,UAAY,QAAU9B,EAAO,OAEjCuB,iBAAiB,QAAS,SAAUK,OAEjC1B,KAhEK,gBACA,4BAgEGF,KAIPmB,MAAMU,QAAU,UAChBL,UAAW,IACXM,UAAY,QAAU9B,EAAO,KAIzB8B,UAHL5B,EAGiB,YAFA,QAAUF,EAAO,MAoC/C,SAAS+B,EAAUC,OACXC,EAAQ7B,SAASC,eAAe2B,GAC9B5B,SAASC,eAAe2B,GACxBE,KAAKC,QAAQ,UAEfF,EAAMG,QAAQC,YAA0C,GAA5BJ,EAAMG,QAAQC,eACxCD,QAAQC,YAAa,EAEvBJ,EAAMhB,UAAUqB,SAAS,gBACnBf,iBACF,gBACCK,MACST,MAAMU,QAAU,SAChBO,QAAQC,YAAa,UAGrB,MAGRpB,UAAUC,OAAO,qBACdqB,KAAKtB,UAAUC,OAAO,eAIvC,MAAMsB,EAAS,cAEF/B,iBAAiB,UAAUM,QAAS0B,MACtClB,iBAAiB,QAAS,SAASK,KAChCc,iBAC0C,GAAxCR,KAAKjB,UAAUqB,SAAS,oBACnBrB,UAAUI,IAAI,kBACdd,cAAc,SAASoC,aAO5C,SAASC,EAAUZ,EAAII,OACfH,EAAQ7B,SAASC,eAAe2B,MAE1B,aAANA,GAAmBD,EAAU,aACvB,wBAANC,GAA8BD,EAAU,wBAClC,yBAANC,GAA+BD,EAAU,yBACnC,gBAANC,GAAsBD,EAAU,gBAC1B,iBAANC,GAAuBD,EAAU,mBAMjCE,EAAMG,QAAQC,YAA0C,GAA5BJ,EAAMG,QAAQC,gBACxCD,QAAQC,YAAa,EAEiB,GAAxCJ,EAAMhB,UAAUqB,SAAS,aAAsB,IAC3CF,EAAQS,KAAM,KACVC,EAAM,IAAIC,iBACVC,KAAK,MAAOZ,EAAQS,MAAM,KAC1BI,mBAAqB,WACG,IAApBf,KAAKgB,YACW,MAAhBhB,KAAKiB,WACH5C,cAAc,iBAAiBuB,UACjCI,KAAKkB,iBAETC,SAGFlC,MAAMU,QAAU,kBACX,aACDZ,UAAUI,IAAI,qBACXkB,KAAKtB,UAAUI,IAAI,eACtBe,QAAQC,YAAa,GAC5B,IAIXjC,SAASmB,iBAAiB,mBAAoB,iBAvGrCd,iBAAiB,oCACjBM,QAAS0B,MACHlB,iBAAiB,QAAS,iBACnB+B,EAAOb,EACRN,QAAQ,oBACRlB,UAAUqB,SAAS,aAClBiB,EAAOd,EAAGlC,cAAc,iBAE1B+C,aAEK7C,iBAAiB,oBAAoBM,QAAS0B,UAC7Cc,EAAOd,EAAGlC,cAAc,mBAC3BU,UAAUC,OAAO,eACfD,UAAUI,IAAI,wBACdJ,UAAUC,OAAO,sBACjBD,UAAUC,OAAO,4BAGrBD,UAAUuC,OAAO,wBACjBvC,UAAUuC,OAAO,sBACjBvC,UAAUuC,OAAO,0BAEnBrB,QAAQ,oBAAoBlB,UAAUuC,OAAO,sBArM7CpD,SAASK,iBAAiB,iBAElCM,QAASD,IACIA,EAAMP,cAAc,cAE5BgB,iBAAiB,QAAUK,MAC7Bc,mBAEIN,QAAQqB,OAAS,QAEjBC,EAAS5C,EAAMP,cAAc,uBAC7BoD,EAAQ7C,EAAMP,cAAc,sBAC5BqD,EAAS9C,EAAMP,cAAc,0BAE/BmD,IAC2B,GAAvBA,EAAOG,MAAMnD,UACNO,UAAUI,IAAI,cACfe,QAAQqB,YAEPxC,UAAUC,OAAO,aAG5ByC,IAC0B,GAAtBA,EAAME,MAAMnD,UACNO,UAAUI,IAAI,cACde,QAAQqB,YAERxC,UAAUC,OAAO,aAG3B0C,IAC2B,GAAvBA,EAAOC,MAAMnD,UACNO,UAAUI,IAAI,cACfe,QAAQqB,YAEPxC,UAAUC,OAAO,aAI5BJ,EAAMsB,QAAQqB,OAAS,gBACjBlD,cAAc,eAAeY,MAAMU,QAAU,WAG7CtB,cAAc,eAAeY,MAAMU,QAAU,aAGjDiC,EAAW,IAAIC,SAASjD,SAExB,sBACM,YACFgD,IAELE,KAAK,SAAUC,UACLA,EAAcC,SAExBF,KAAK,SAAUG,MACRA,EAAKC,mBACCD,EAAKC,QACJ,QAEL,wCAgOhBhE,SAASG,cAAc,wBACnB,kCAGDE,iBAAiB,UAAUM,QAAS0B,MACtClB,iBAAiB,QAAS,SAAUK,GAC/BA,EAAEyC,QAAU5B,KACFb,EAAEyC,OAAOrC,iBAItBO,KAAKhB,iBAAiB,QAAS,SAAUK,SACxC0C,EAAS1C,EAAEyC,OAAOlC,QAAQ,kBAC5BmC,MACE5B,mBACQ6B,KAAKD,UAGbE,EAAQ5C,EAAEyC,OAAOlC,QAAQ,kBAC3BqC,MACE9B,mBACQ8B,EAAMpC,QAAQiC,OAAQG,EAAMpC,YAI1CzC,OAAOC,YAAc,KAAM,CACL,IAAI6E,OAAO,kCACd,eACD,sBAGF,+BACA,iCAMdC,EAAoBtE,SAASG,cAAc,mCAE7CoE,EACAC,EAAYxE,SAASG,cAAc,oBAAoBE,iBAAiB,iBAAiBC,WACxF,IAAImE,EAAQ,EAAGA,EAAQD,EAAWC,IAAS,OACtCpD,EAAMrB,SAASsB,cAAc,SAC/BT,UAAUI,IAAI,8BACdJ,UAAUI,IAAI,0BACAM,YAAYF,GAEZ,IAAIgD,OAAO,oCAElB,2BACe,wBAGLK,EAAGC,EAAMC,KACXC,KAAKC,MAAqB,KAAd,EAAIF,MACT7D,MAAMgE,YAAY,aAAcH,EAAY,WAE5D,SAASF,iBAEF,SAASA,GACdA,EAAEH,WAAaA,MAEGlE,iBAAiB,yBAAyBM,QAAS0B,MAC9DxB,UAAUC,OAAO,iBAENT,iBAAiB,yBAAyBqE,EAAEH,WAAW1D,UAAUI,IAAI,eAE3EyD,EAAEH,2BAIX,oBACD,SACR"}